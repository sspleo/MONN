{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": [
    "from collections import defaultdict\n",
    "import os\n",
    "import pickle\n",
    "import sys\n",
    "import numpy as np\n",
    "from rdkit import Chem\n",
    "from rdkit.Chem import AllChem\n",
    "from rdkit import DataStructs\n",
    "from rdkit.ML.Cluster import Butina\n",
    "from scipy.cluster.hierarchy import fcluster, linkage, single\n",
    "from scipy.spatial.distance import pdist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "import networkx as nx\n",
    "from networkx.algorithms import bipartite\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "B = nx.Graph()\n",
    "## node list of bipartite 0\n",
    "B.add_nodes_from(['A', 'B', 'C', 'D'], bipartite = 0)\n",
    "## node list of bipartite 1\n",
    "B.add_nodes_from([1,2,3], bipartite=1)\n",
    "\n",
    "## add edges between them\n",
    "B.add_edges_from([('A',1),('A',2), ('B',1), ('C',1), ('D',1),('D',2),('D',3)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "G = nx.Graph()\n",
    "G.add_nodes_from(valid_cid_list, bipartite = 0)\n",
    "G.add_nodes_from(valid_pid_list, bipartite = 1)\n",
    "G.add_edges_from(valid_pair_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [],
   "source": [
    "top = valid_cid_list\n",
    "pos = nx.bipartite_layout(G, top)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [],
   "source": [
    "color_map = []\n",
    "for element in G:\n",
    "    if element in top:\n",
    "        color_map.append('red')\n",
    "    else:\n",
    "        color_map.append('green')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(num=None, figsize=(80, 60), dpi=80, facecolor='w', edgecolor='k')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "nx.draw_networkx(G, pos = pos, node_color = color_map, with_labels=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Check if B is bipartite set\n",
    "bipartite.is_bipartite(B)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [],
   "source": [
    "set0 = bipartite.sets(B)[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "top = nx.bipartite.sets(B)[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "pos = nx.bipartite_layout(B,top)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [],
   "source": [
    "color_map = []\n",
    "for node in B:\n",
    "    if node in set0:\n",
    "        color_map.append('red')\n",
    "    else:\n",
    "        color_map.append('green')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "nx.draw_networkx(B, pos = pos, node_color = color_map, with_labels=True, font_weight = 'bold')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "elem_list = ['C', 'N', 'O', 'S', 'F', 'Si', 'P', 'Cl', 'Br', 'Mg', 'Na', 'Ca', 'Fe', 'As', 'Al', 'I', 'B', 'V', 'K', 'Tl', 'Yb', 'Sb', 'Sn', 'Ag', 'Pd', 'Co', 'Se', 'Ti', 'Zn', 'H', 'Li', 'Ge', 'Cu', 'Au', 'Ni', 'Cd', 'In', 'Mn', 'Zr', 'Cr', 'Pt', 'Hg', 'Pb', 'W', 'Ru', 'Nb', 'Re', 'Te', 'Rh', 'Tc', 'Ba', 'Bi', 'Hf', 'Mo', 'U', 'Sm', 'Os', 'Ir', 'Ce','Gd','Ga','Cs', 'unknown']\n",
    "aa_list = ['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y']\n",
    "atom_fdim = len(elem_list) + 6 + 6 + 6 + 1\n",
    "bond_fdim = 6\n",
    "max_nb = 6\n",
    "\n",
    "\n",
    "def onek_encoding_unk(x, allowable_set):\n",
    "    if x not in allowable_set:\n",
    "        x = allowable_set[-1]\n",
    "    return list(map(lambda s: x == s, allowable_set))\n",
    "\n",
    "\n",
    "def atom_features(atom):\n",
    "    return np.array(onek_encoding_unk(atom.GetSymbol(), elem_list) \n",
    "            + onek_encoding_unk(atom.GetDegree(), [0,1,2,3,4,5]) \n",
    "            + onek_encoding_unk(atom.GetExplicitValence(), [1,2,3,4,5,6])\n",
    "            + onek_encoding_unk(atom.GetImplicitValence(), [0,1,2,3,4,5])\n",
    "            + [atom.GetIsAromatic()], dtype=np.float32)\n",
    "\n",
    "\n",
    "def bond_features(bond):\n",
    "    bt = bond.GetBondType()\n",
    "    return np.array([bt == Chem.rdchem.BondType.SINGLE, bt == Chem.rdchem.BondType.DOUBLE, bt == Chem.rdchem.BondType.TRIPLE, \\\n",
    "    bt == Chem.rdchem.BondType.AROMATIC, bond.GetIsConjugated(), bond.IsInRing()], dtype=np.float32)\n",
    "\n",
    "\n",
    "def Mol2Graph(mol):\n",
    "    # convert molecule to GNN input\n",
    "    idxfunc=lambda x:x.GetIdx()\n",
    "\n",
    "    n_atoms = mol.GetNumAtoms()\n",
    "    assert mol.GetNumBonds() >= 0\n",
    "\n",
    "    n_bonds = max(mol.GetNumBonds(), 1)\n",
    "    fatoms = np.zeros((n_atoms,), dtype=np.int32) #atom feature ID\n",
    "    fbonds = np.zeros((n_bonds,), dtype=np.int32) #bond feature ID\n",
    "    atom_nb = np.zeros((n_atoms, max_nb), dtype=np.int32)\n",
    "    bond_nb = np.zeros((n_atoms, max_nb), dtype=np.int32)\n",
    "    num_nbs = np.zeros((n_atoms,), dtype=np.int32)\n",
    "    num_nbs_mat = np.zeros((n_atoms,max_nb), dtype=np.int32)\n",
    "\n",
    "    for atom in mol.GetAtoms():\n",
    "        idx = idxfunc(atom)\n",
    "        fatoms[idx] = atom_dict[''.join(str(x) for x in atom_features(atom).astype(int).tolist())] \n",
    "\n",
    "    for bond in mol.GetBonds():\n",
    "        a1 = idxfunc(bond.GetBeginAtom())\n",
    "        a2 = idxfunc(bond.GetEndAtom())\n",
    "        idx = bond.GetIdx()\n",
    "        fbonds[idx] = bond_dict[''.join(str(x) for x in bond_features(bond).astype(int).tolist())] \n",
    "        try:\n",
    "            atom_nb[a1,num_nbs[a1]] = a2\n",
    "            atom_nb[a2,num_nbs[a2]] = a1\n",
    "        except:\n",
    "            return [], [], [], [], []\n",
    "        bond_nb[a1,num_nbs[a1]] = idx\n",
    "        bond_nb[a2,num_nbs[a2]] = idx\n",
    "        num_nbs[a1] += 1\n",
    "        num_nbs[a2] += 1\n",
    "        \n",
    "    for i in range(len(num_nbs)):\n",
    "        num_nbs_mat[i,:num_nbs[i]] = 1\n",
    "\n",
    "    return fatoms, fbonds, atom_nb, bond_nb, num_nbs_mat\n",
    "\n",
    "\n",
    "def Batch_Mol2Graph(mol_list):\n",
    "    res = list(map(lambda x:Mol2Graph(x), mol_list))\n",
    "    fatom_list, fbond_list, gatom_list, gbond_list, nb_list = zip(*res)\n",
    "    return fatom_list, fbond_list, gatom_list, gbond_list, nb_list\n",
    "\n",
    "\n",
    "def Protein2Sequence(sequence, ngram=1):\n",
    "    # convert sequence to CNN input\n",
    "    sequence = sequence.upper()\n",
    "    word_list = [sequence[i:i+ngram] for i in range(len(sequence)-ngram+1)]\n",
    "    output = []\n",
    "    for word in word_list:\n",
    "        if word not in aa_list:\n",
    "            output.append(word_dict['X'])\n",
    "        else:\n",
    "            output.append(word_dict[word])\n",
    "    if ngram == 3:\n",
    "        output = [-1]+output+[-1] # pad\n",
    "    return np.array(output, np.int32)\n",
    "\n",
    "\n",
    "def Batch_Protein2Sequence(sequence_list, ngram=3):\n",
    "    res = list(map(lambda x:Protein2Sequence(x,ngram), sequence_list))\n",
    "    return res\n",
    "\n",
    "\n",
    "def get_mol_dict():\n",
    "    if os.path.exists('../data/mol_dict'):\n",
    "        with open('../data/mol_dict') as f:\n",
    "            mol_dict = pickle.load(f)\n",
    "    else:\n",
    "        mol_dict = {}\n",
    "        mols = Chem.SDMolSupplier('../data/Components-pub.sdf')\n",
    "        for m in mols:\n",
    "            if m is None:\n",
    "                continue\n",
    "            name = m.GetProp(\"_Name\")\n",
    "            mol_dict[name] = m\n",
    "        with open('../data/mol_dict', 'wb') as f:\n",
    "            pickle.dump(mol_dict, f)\n",
    "    #print('mol_dict',len(mol_dict))\n",
    "    return mol_dict\n",
    "\n",
    "\n",
    "def get_pairwise_label(pdbid, interaction_dict):\n",
    "    if pdbid in interaction_dict:\n",
    "        sdf_element = np.array([atom.GetSymbol().upper() for atom in mol.GetAtoms()])\n",
    "        atom_element = np.array(interaction_dict[pdbid]['atom_element'], dtype=str)\n",
    "        atom_name_list = np.array(interaction_dict[pdbid]['atom_name'], dtype=str)\n",
    "        atom_interact = np.array(interaction_dict[pdbid]['atom_interact'], dtype=int)\n",
    "        nonH_position = np.where(atom_element != ('H'))[0]\n",
    "        assert sum(atom_element[nonH_position] != sdf_element) == 0\n",
    "        \n",
    "        atom_name_list = atom_name_list[nonH_position].tolist()\n",
    "        pairwise_mat = np.zeros((len(nonH_position), len(interaction_dict[pdbid]['uniprot_seq'])), dtype=np.int32)\n",
    "        for atom_name, bond_type in interaction_dict[pdbid]['atom_bond_type']:\n",
    "            atom_idx = atom_name_list.index(str(atom_name))\n",
    "            assert atom_idx < len(nonH_position)\n",
    "            \n",
    "            seq_idx_list = []\n",
    "            for seq_idx, bond_type_seq in interaction_dict[pdbid]['residue_bond_type']:\n",
    "                if bond_type == bond_type_seq:\n",
    "                    seq_idx_list.append(seq_idx)\n",
    "                    pairwise_mat[atom_idx, seq_idx] = 1\n",
    "        if len(np.where(pairwise_mat != 0)[0]) != 0:\n",
    "            pairwise_mask = True\n",
    "            return True, pairwise_mat\n",
    "    return False, np.zeros((1,1))\n",
    "\n",
    "\n",
    "def get_fps(mol_list):\n",
    "    fps = []\n",
    "    for mol in mol_list:\n",
    "        fp = AllChem.GetMorganFingerprintAsBitVect(mol,2,nBits=1024,useChirality=True)\n",
    "        fps.append(fp)\n",
    "    #print('fingerprint list',len(fps))\n",
    "    return fps\n",
    "\n",
    "\n",
    "def calculate_sims(fps1,fps2,simtype='tanimoto'):\n",
    "    sim_mat = np.zeros((len(fps1),len(fps2))) #,dtype=np.float32)\n",
    "    for i in range(len(fps1)):\n",
    "        fp_i = fps1[i]\n",
    "        if simtype == 'tanimoto':\n",
    "            sims = DataStructs.BulkTanimotoSimilarity(fp_i,fps2)\n",
    "        elif simtype == 'dice':\n",
    "            sims = DataStructs.BulkDiceSimilarity(fp_i,fps2)\n",
    "        sim_mat[i,:] = sims\n",
    "    return sim_mat\n",
    "\n",
    "\n",
    "def compound_clustering(ligand_list, mol_list):\n",
    "    print 'start compound clustering...'\n",
    "    fps = get_fps(mol_list)\n",
    "    sim_mat = calculate_sims(fps, fps)\n",
    "    #np.save('../preprocessing/'+MEASURE+'_compound_sim_mat.npy', sim_mat)\n",
    "    print 'compound sim mat', sim_mat.shape\n",
    "    C_dist = pdist(fps, 'jaccard')\n",
    "    C_link = single(C_dist)\n",
    "    for thre in [0.3, 0.4, 0.5, 0.6]:\n",
    "        C_clusters = fcluster(C_link, thre, 'distance')\n",
    "        len_list = []\n",
    "        for i in range(1,max(C_clusters)+1):\n",
    "            len_list.append(C_clusters.tolist().count(i))\n",
    "        print 'thre', thre, 'total num of compounds', len(ligand_list), 'num of clusters', max(C_clusters), 'max length', max(len_list)\n",
    "        C_cluster_dict = {ligand_list[i]:C_clusters[i] for i in range(len(ligand_list))}\n",
    "        with open('../preprocessing/'+MEASURE+'_compound_cluster_dict_'+str(thre),'wb') as f:\n",
    "            pickle.dump(C_cluster_dict, f, protocol=0)\n",
    "\n",
    "\n",
    "def protein_clustering(protein_list, idx_list):\n",
    "    print 'start protein clustering...'\n",
    "    protein_sim_mat = np.load('../data/pdbbind_protein_sim_mat.npy').astype(np.float32)\n",
    "    sim_mat = protein_sim_mat[idx_list, :]\n",
    "    sim_mat = sim_mat[:, idx_list]\n",
    "    print 'original protein sim_mat', protein_sim_mat.shape, 'subset sim_mat', sim_mat.shape\n",
    "    #np.save('../preprocessing/'+MEASURE+'_protein_sim_mat.npy', sim_mat)\n",
    "    P_dist = []\n",
    "    for i in range(sim_mat.shape[0]):\n",
    "        P_dist += (1-sim_mat[i,(i+1):]).tolist()\n",
    "    P_dist = np.array(P_dist)\n",
    "    P_link = single(P_dist)\n",
    "    for thre in [0.3, 0.4, 0.5, 0.6]:\n",
    "        P_clusters = fcluster(P_link, thre, 'distance')\n",
    "        len_list = []\n",
    "        for i in range(1,max(P_clusters)+1):\n",
    "            len_list.append(P_clusters.tolist().count(i))\n",
    "        print 'thre', thre, 'total num of proteins', len(protein_list), 'num of clusters', max(P_clusters), 'max length', max(len_list)\n",
    "        P_cluster_dict = {protein_list[i]:P_clusters[i] for i in range(len(protein_list))}\n",
    "        with open('../preprocessing/'+MEASURE+'_protein_cluster_dict_'+str(thre),'wb') as f:\n",
    "            pickle.dump(P_cluster_dict, f, protocol=0)\n",
    "\n",
    "def pickle_dump(dictionary, file_name):\n",
    "    pickle.dump(dict(dictionary), open(file_name, 'wb'), protocol=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "MEASURE = 'KIKD' # 'IC50' or 'KIKD'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "20"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mol_dict = get_mol_dict()\n",
    "with open('../data/out7_final_pairwise_interaction_dict','rb') as f:\n",
    "    interaction_dict = pickle.load(f)\n",
    "\n",
    "wlnn_train_list = []\n",
    "atom_dict = defaultdict(lambda: len(atom_dict))\n",
    "bond_dict = defaultdict(lambda: len(bond_dict))\n",
    "word_dict = defaultdict(lambda: len(word_dict))\n",
    "for aa in aa_list:\n",
    "    word_dict[aa]\n",
    "word_dict['X']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Step 2/5, generating labels...\n",
      "processed sample num 1000\n",
      "processed sample num 2000\n",
      "processed sample num 3000\n",
      "processed sample num 4000\n",
      "processed sample num 5000\n",
      "processed sample num 6000\n",
      "processed sample num 7000\n",
      "processed sample num 8000\n",
      "processed sample num 9000\n",
      "processed sample num 10000\n",
      "processed sample num 11000\n",
      "processed sample num 12000\n",
      "processed sample num 13000\n"
     ]
    }
   ],
   "source": [
    "i = 0\n",
    "pair_info_dict = {}\n",
    "f = open('../data/pdbbind_all_datafile.tsv')\n",
    "print 'Step 2/5, generating labels...'\n",
    "for line in f.readlines():\n",
    "    i += 1\n",
    "    if i % 1000 == 0:\n",
    "        print 'processed sample num', i\n",
    "    pdbid, pid, cid, inchi, seq, measure, label = line.strip().split('\\t')\n",
    "    # filter interaction type and invalid molecules\n",
    "    if MEASURE == 'All':\n",
    "        pass\n",
    "    elif MEASURE == 'KIKD':\n",
    "        if measure not in ['Ki', 'Kd']:\n",
    "            continue\n",
    "    elif measure != MEASURE:\n",
    "        continue\n",
    "    if cid not in mol_dict:\n",
    "        print 'ligand not in mol_dict'\n",
    "        continue\n",
    "    mol = mol_dict[cid]\n",
    "    \n",
    "    # get labels\n",
    "    value = float(label)\n",
    "    pairwise_mask, pairwise_mat = get_pairwise_label(pdbid, interaction_dict)\n",
    "    \n",
    "    # handle the condition when multiple PDB entries have the same Uniprot ID and Inchi\n",
    "    if inchi+' '+pid not in pair_info_dict:\n",
    "        pair_info_dict[inchi+' '+pid] = [pdbid, cid, pid, value, mol, seq, pairwise_mask, pairwise_mat]\n",
    "    else:\n",
    "        if pair_info_dict[inchi+' '+pid][6]:\n",
    "            if pairwise_mask and pair_info_dict[inchi+' '+pid][3] < value:\n",
    "                pair_info_dict[inchi+' '+pid] = [pdbid, cid, pid, value, mol, seq, pairwise_mask, pairwise_mat]\n",
    "        else:\n",
    "            if pair_info_dict[inchi+' '+pid][3] < value:\n",
    "                pair_info_dict[inchi+' '+pid] = [pdbid, cid, pid, value, mol, seq, pairwise_mask, pairwise_mat]\n",
    "f.close()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/leoseo/opt/anaconda3/envs/p2env/lib/python2.7/site-packages/ipykernel_launcher.py:12: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.\n",
      "  if sys.path[0] == '':\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "num of neighbor > 6,  84A\n",
      "num of neighbor > 6,  B1R\n",
      "num of neighbor > 6,  670\n",
      "num of neighbor > 6,  B9F\n",
      "num of neighbor > 6,  498\n",
      "num of neighbor > 6,  067\n"
     ]
    }
   ],
   "source": [
    "valid_value_list = []\n",
    "valid_cid_list = []\n",
    "valid_pid_list = []\n",
    "valid_pairwise_mask_list = []\n",
    "valid_pairwise_mat_list = []\n",
    "mol_inputs, seq_inputs = [], []\n",
    "\n",
    "# get inputs\n",
    "for item in pair_info_dict:\n",
    "    pdbid, cid, pid, value, mol, seq, pairwise_mask, pairwise_mat = pair_info_dict[item]\n",
    "    fa, fb, anb, bnb, nbs_mat = Mol2Graph(mol)\n",
    "    if fa==[]:\n",
    "        print 'num of neighbor > 6, ', cid\n",
    "        continue\n",
    "    mol_inputs.append([fa, fb, anb, bnb, nbs_mat])\n",
    "    seq_inputs.append(Protein2Sequence(seq,ngram=1))\n",
    "    valid_value_list.append(value)\n",
    "    valid_cid_list.append(cid)\n",
    "    valid_pid_list.append(pid)\n",
    "    valid_pairwise_mask_list.append(pairwise_mask)\n",
    "    valid_pairwise_mat_list.append(pairwise_mat)\n",
    "    wlnn_train_list.append(pdbid)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [],
   "source": [
    "valid_pair_list = []\n",
    "for i in range(len(valid_cid_list)):\n",
    "    pair = [valid_cid_list[i], valid_pid_list[i]]\n",
    "    valid_pair_list.append(pair)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "6989"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(valid_pair_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['CTB', 'P00811']"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "valid_pair_list[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.15"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
